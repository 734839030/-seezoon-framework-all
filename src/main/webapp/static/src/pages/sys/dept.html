<!DOCTYPE html>
<html>
<head>@@include('../common/header.html',{"title":"部门管理"})
@@include('../common/tree.html')
</head>
<body class="hold-transition skin-blue sidebar-mini">
	<div class="wrapper">
		<div class="content-wrapper ml0">
			<section class="content-header">
				<h1>部门管理</h1>
				<ol class="breadcrumb">
					<li><a href="#"><i class="fa fa-dashboard"></i>系统管理</a></li>
					<li class="active">部门管理</li>
				</ol>
			</section>
			<section class="content container-fluid">
				<div class="box box-primary">
					<div class="box-body">
						<form class="form-inline" way-data="model.search">
							<div class="form-group">
								<input type="text" class="form-control" placeholder="名称"
									name="name" way-data="name" maxlength="50">
							</div>
							<button type="button" class="btn btn-default" id="search">
								<i class="fa fa-search"></i>
							</button>
							<div class="btn-group pull-right">
								<button type="button" class="btn btn-primary" id="add">
									<i class="fa fa-plus"></i>
								</button>
								<button type="button" class="btn btn-info" id="edit">
									<i class="fa fa-edit"></i>
								</button>
								<button type="button" class="btn btn-danger" id="delete">
									<i class="fa fa-trash-o"></i>
								</button>
							</div>
						</form>
					</div>
				</div>
				<div class="box">
					<div class="box-body">
						<!-- table -->
						<table id="table"></table>
					</div>
				</div>
			</section>
		</div>
	</div>
	<!-- 添加与修改start -->
	<div class="modal fade" id="form-panel" way-scope="model.form">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<h4 class="modal-title" way-data="title" way-html="true"></h4>
				</div>
				<form class="form-horizontal" way-scope="data" id="data-form">
					<div class="modal-body">
						<input type="hidden" way-data="id" name="id">
						<div class="form-group">
							<label class="col-sm-2 control-label">上级部门<font
								class="text-red">*</font></label>
							<div class="col-sm-5">
								<input type="hidden" way-data="parentId" name="parentId">
								<input type="text" class="form-control" way-data="parentName"
									id="parent-input" name="parentName" readonly="readonly">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-2 control-label">名称<font
								class="text-red">*</font></label>
							<div class="col-sm-5">
								<input type="text" class="form-control" way-data="name"
									maxlength="50" minlength="1" name="name" required
									placeholder="">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-2 control-label">排序<font
								class="text-red">*</font></label>
							<div class="col-sm-5">
								<input type="number" class="form-control" way-data="sort"
									maxlength="10" minlength="1" name="sort" required
									placeholder="">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-2 control-label">备注</label>
							<div class="col-sm-10">
								<textarea class="form-control" rows="3" way-data="remarks"
									name="remarks" maxlength="255"></textarea>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default pull-left"
							data-dismiss="modal">
							<i class="fa fa-times"></i> 取消
						</button>
						<button type="submit" class="btn btn-primary">
							<i class="fa fa-save"></i> 保存
						</button>
					</div>
				</form>
			</div>
		</div>
	</div>
	<!-- 添加与修改end -->
	@@include('../common/common-js.html')
	<!-- @@include('../common/dept.html') -->
	<!-- 部门组件 -->
	<div id="deptLayer" class="undisplay pd10">
		<ul id="deptTree" class="ztree ">

		</ul>
	</div>
	<script type="text/javascript">
;(function($) {
	$.seezoon = {
		chooseDept:function(clickCallback){
			var setting = {
					data : {
						simpleData : {
							enable : true,
							idKey : "id",
							pIdKey : "parentId",
						}
					},
					callback : {
						onClick : function(event, treeId, treeNode) {
							clickCallback(event, treeId, treeNode);
						}
					}
				};
				$.post(requestPath + "/sys/dept/qryAll.do", function(respone) {
					//选择上级tree
					$.fn.zTree.init($("#deptTree"), setting,respone.data);
					var treeObj = $.fn.zTree.getZTreeObj("deptTree");
					treeObj.expandAll(true);
				});
				layer.open({
				 	  title:'上级部门',
				 	  offset: '50px',
		              skin: 'layui-layer-molv',
		              shade: 0,
		              shadeClose: false,
				 	  icon: 1,
				 	  area: ['300px', '450px'],
					  type: 1, 
					  btn: ['清除'],
					  yes:function(){
						  way.set("model.form.data.parentId",null);
						  way.set("model.form.data.parentName","无");
						  layer.close(index);
					  },
					  content:  $("#deptLayer") 
					});
		}
	}
})(jQuery);
</script>
	<script src="/js/sys/dept.js"></script>
</body>
</html>